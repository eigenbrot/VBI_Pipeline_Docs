
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>collect_intersections &#8212; VBI_Pipeline v0.7.1</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700" />
    <link rel="stylesheet" type="text/css" href="../_static/dkist.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favico.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="command_line" href="VBI_Pipeline.TargetCalibration.command_line.html" />
    <link rel="prev" title="validate_gain_task_data" href="VBI_Pipeline.GainCalibration.validate_gain_task_data.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="col-md-3 navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://nso.edu"><img src="../_static/img/NSOlogo.gif">
        </a>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav hidden">
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">VBI Pipeline Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../walkthrough.html">Data Reduction Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config_file.html">Configuration File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IPA_access.html">Instrument Partner Testing Access</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">Reference/API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">collect_intersections</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="VBI_Pipeline.GainCalibration.validate_gain_task_data.html" title="Previous Chapter: validate_gain_task_data"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; validate_gain...</span>
    </a>
  </li>
  <li>
    <a href="VBI_Pipeline.TargetCalibration.command_line.html" title="Next Chapter: command_line"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">command_line &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>
          
            <ul class="nav navbar-nav navbar-left">
              <li><a href="http://dkist.nso.edu/">DKIST</a></li>
              <li><a href="http://docs.cadair.com/devdocs">DC Developer Guide</a></li>
              <li><a href="http://docs.cadair.com/datarate">DKIST Data Rate</a></li>
              <li><a href="http://docs.cadair.com/datamodel">DKIST Data Model</a></li>
            </ul>
          
          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">

    <div class="col-md-3"><div id="side-logo" >
            <a href="http://dkist.nso.edu">
                <img src="../_static/img/DKISTLogo-Medium.jpg">
            </a>
        </div><div id="sidebar" class="bs-sidenav" role="complementary">
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">VBI Pipeline Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../walkthrough.html">Data Reduction Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config_file.html">Configuration File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IPA_access.html">Instrument Partner Testing Access</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">Reference/API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.VBIPipeline">VBI_Pipeline.VBIPipeline Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.VBIStitch">VBI_Pipeline.VBIStitch Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.DarkCalibration">VBI_Pipeline.DarkCalibration Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.GainCalibration">VBI_Pipeline.GainCalibration Module</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../API.html#module-VBI_Pipeline.TargetCalibration">VBI_Pipeline.TargetCalibration Module</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../API.html#id6">Functions</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">collect_intersections</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.command_line.html">command_line</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.do_single_frame.html">do_single_frame</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.find_intersections.html">find_intersections</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.generate_target_calibration.html">generate_target_calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.load_hough_pickle.html">load_hough_pickle</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.main.html">main</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.make_binary_gauss.html">make_binary_gauss</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.Data">VBI_Pipeline.Data Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.generic">VBI_Pipeline.generic Module</a></li>
</ul>
</li>
</ul>

            
        </div>
    </div>

    <div class="col-md-9 content">
      
  <div class="section" id="collect-intersections">
<h1>collect_intersections<a class="headerlink" href="#collect-intersections" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="VBI_Pipeline.TargetCalibration.collect_intersections">
<code class="descclassname">VBI_Pipeline.TargetCalibration.</code><code class="descname">collect_intersections</code><span class="sig-paren">(</span><em>gridData</em>, <em>rho_min_dist</em>, <em>gauss_sigma=30.0</em>, <em>rho_smooth=10</em>, <em>binary_threshold=0.1</em>, <em>sigclip=3</em>, <em>debug=False</em>, <em>**hough_args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/VBI_Pipeline/TargetCalibration.html#collect_intersections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#VBI_Pipeline.TargetCalibration.collect_intersections" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a list grid intersection points for each hdu in the input data.</p>
<p>The general algorithm for each hdu is:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Create a binary image</li>
<li>Find grid lines using the Hough Transform</li>
<li>Compute the intersections of all of the discovered lines</li>
</ol>
</div></blockquote>
<p>See associated helper functions for more detailed information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>gridData</strong> : Data.FitsData</p>
<blockquote>
<div><p>Data object containing a linegrid image or series thereof</p>
</div></blockquote>
<p><strong>rho_min_dist</strong> : float</p>
<blockquote>
<div><p>Minimum distance (in Hough space coordinates) allowed between peaks in rho. This parameter is highly dependent
on the pixel scale of the grid lines.</p>
</div></blockquote>
<p><strong>gauss_sigma</strong> : float</p>
<blockquote>
<div><p>Width of smoothing kernel used to construct a binary image from the input data. Should be slightly less than
the pixel width of the grid lines.</p>
</div></blockquote>
<p><strong>rho_smooth</strong> : float</p>
<blockquote>
<div><p>Sigma of smoothing kernel used to remove noise from the rho rss. Something b/t 5 and 10 is probably good.</p>
</div></blockquote>
<p><strong>binary_threshold</strong> : float</p>
<blockquote>
<div><p>Min percentage of pixels to be on one side of the Otsu threshold when constructing the binary image.
If the percentage of pixels above the threshold is outside the range (binary_threshold, 1 - binary_threshold),
then some cleaning of outlying pixels is performed.</p>
</div></blockquote>
<p><strong>sigclip</strong> : float</p>
<blockquote>
<div><p>Any pixels beyond sigclip standard deviations from the mean are excluded from the binary thresholding
calculation.</p>
</div></blockquote>
<p><strong>debug</strong> : bool</p>
<blockquote>
<div><p>If True the code will stop at each hdu (i.e., exposure) and generate some diagnostic plots that show the
computed lines and grid intersections.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">lst</p>
<blockquote>
<div><p>Each element of this list corresponds to a single input hdu and contains a numpy array of shape (2,
N) containing the (x,y) corrdinates for the N intersections found in that hdu.</p>
</div></blockquote>
<p>lst</p>
<blockquote class="last">
<div><p>A list containing the camera positions (VBI__005) of each corresponding hdu</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <div class="left-footer">
         &copy; 2019, Arthur Eigenbrot
       <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
    </div>
   
    <div class="right-footer">
      Last updated on 08 May 2019.
    </div>
    <div class="centre-footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5
    </div>
  </div>
</footer>
  </body>
</html>
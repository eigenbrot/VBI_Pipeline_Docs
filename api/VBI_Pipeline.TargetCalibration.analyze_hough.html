
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>analyze_hough &#8212; VBI_Pipeline v1.0.0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700" type="text/css" />
    <link rel="stylesheet" href="../_static/dkist.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favico.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="check_shifts" href="VBI_Pipeline.TargetCalibration.check_shifts.html" />
    <link rel="prev" title="validate_gain_task_data" href="VBI_Pipeline.GainCalibration.validate_gain_task_data.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="col-md-3 navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://nso.edu"><img src="../_static/img/NSOlogo.gif">
        </a>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav hidden">
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">VBI Pipeline Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../walkthrough.html">Data Reduction Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config_file.html">Configuration File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IPA_access.html">Instrument Partner Testing Access</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">Reference/API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">analyze_hough</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="VBI_Pipeline.GainCalibration.validate_gain_task_data.html" title="Previous Chapter: validate_gain_task_data"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; validate_gain...</span>
    </a>
  </li>
  <li>
    <a href="VBI_Pipeline.TargetCalibration.check_shifts.html" title="Next Chapter: check_shifts"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">check_shifts &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>
          
            <ul class="nav navbar-nav navbar-left">
              <li><a href="http://dkist.nso.edu/">DKIST</a></li>
            </ul>
          
          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">

    <div class="col-md-3"><div id="side-logo" >
            <a href="http://dkist.nso.edu">
                <img src="../_static/img/DKISTLogo-Medium.jpg">
            </a>
        </div><div id="sidebar" class="bs-sidenav" role="complementary">
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">VBI Pipeline Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../walkthrough.html">Data Reduction Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../config_file.html">Configuration File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IPA_access.html">Instrument Partner Testing Access</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../API.html">Reference/API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.VBIPipeline">VBI_Pipeline.VBIPipeline Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.VBIStitch">VBI_Pipeline.VBIStitch Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.DarkCalibration">VBI_Pipeline.DarkCalibration Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.GainCalibration">VBI_Pipeline.GainCalibration Module</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../API.html#module-VBI_Pipeline.TargetCalibration">VBI_Pipeline.TargetCalibration Module</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../API.html#id6">Functions</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">analyze_hough</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.check_shifts.html">check_shifts</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.collect_intersections.html">collect_intersections</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.command_line.html">command_line</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.find_intersections.html">find_intersections</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.find_match_idx.html">find_match_idx</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.fwhm.html">fwhm</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.gen_debug_plots.html">gen_debug_plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.generate_target_calibration.html">generate_target_calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.load_hough_pickle.html">load_hough_pickle</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.main.html">main</a></li>
<li class="toctree-l4"><a class="reference internal" href="VBI_Pipeline.TargetCalibration.make_binary_gauss.html">make_binary_gauss</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.Data">VBI_Pipeline.Data Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../API.html#module-VBI_Pipeline.generic">VBI_Pipeline.generic Module</a></li>
</ul>
</li>
</ul>

            
        </div>
    </div>

    <div class="body col-md-9 content" role="main">
      
  <section id="analyze-hough">
<h1>analyze_hough<a class="headerlink" href="#analyze-hough" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="VBI_Pipeline.TargetCalibration.analyze_hough">
<span class="sig-prename descclassname"><span class="pre">VBI_Pipeline.TargetCalibration.</span></span><span class="sig-name descname"><span class="pre">analyze_hough</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.008726646259971648</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/VBI_Pipeline/TargetCalibration.html#analyze_hough"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#VBI_Pipeline.TargetCalibration.analyze_hough" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the equations for all the horizontal and vertical lines in a data array.</p>
<p>The lines are found using a Hough Transform and are thus parametrized by (theta, rho). Before the Hough Transform
the data are converted to a binary array and the actual transform is done using skimage.</p>
<p>The lines discovered by the transform are constrained to be within +/- 20 degrees of horizontal or vertical.
Finally, any lines with angles that significantly deviate from the group average are removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Input data array. Should be 2-d</p>
</dd>
<dt><strong>gauss_sigma</strong><span class="classifier">float</span></dt><dd><p>Width of smoothing kernel used to construct a binary image from the input data. Should be slightly less than
the pixel width of the grid lines.</p>
</dd>
<dt><strong>theta_window</strong><span class="classifier">float</span></dt><dd><p>Window in radians around (before and after) each peak angle within which to search for peaks in rho.</p>
</dd>
<dt><strong>rho_window</strong><span class="classifier">float</span></dt><dd><p>Window in pixels around (before and after) each peak rho value within which to refine location of peak angle.</p>
</dd>
<dt><strong>theta_min_dist</strong><span class="classifier">float</span></dt><dd><p>Minimum distance (in Hough space coordinates) allowed between peaks in theta.</p>
</dd>
<dt><strong>rho_min_dist</strong><span class="classifier">float</span></dt><dd><p>Minimum distance (in Hough space coordinates) allowed between peaks in rho. This parameter is highly dependent
on the pixel scale of the grid lines.</p>
</dd>
<dt><strong>rho_smooth</strong><span class="classifier">float</span></dt><dd><p>Sigma of smoothing kernel used to remove noise from the rho rss. Something b/t 5 and 10 is probably good.</p>
</dd>
<dt><strong>binary_threshold</strong><span class="classifier">float</span></dt><dd><p>Min percentage of pixels to be on one side of the Otsu threshold when constructing the binary image.
If the percentage of pixels above the threshold is outside the range (binary_threshold, 1 - binary_threshold),
then some cleaning of outlying pixels is performed.</p>
</dd>
<dt><strong>peak_threshold</strong><span class="classifier">float</span></dt><dd><p>Relative cutoff for detecting peaks in the Hough transform [0 - 1]. Larger numbers will exclude shorter lines,
but can help if spurious lines are being detected.</p>
</dd>
<dt><strong>refine_theta</strong><span class="classifier">bool</span></dt><dd><p>If True then re-compute the angle of each identified lines. Otherwise all lines are assigned the global average.</p>
</dd>
<dt><strong>sigclip</strong><span class="classifier">float</span></dt><dd><p>Any pixels beyond sigclip standard deviations from the mean are excluded from the binary thresholding
calculation.</p>
</dd>
<dt><strong>debug</strong><span class="classifier">bool</span></dt><dd><p>If True the code will stop at each hdu (i.e., exposure) and generate some diagnostic plots that show the
computed lines and grid intersections.</p>
</dd>
<dt><strong>binary</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>The binary image of <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code>. Only used for making debug images.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>tuple</dt><dd><p>(rho, theta) where each element is an ndarray with the associated values</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <div class="left-footer">
         &copy; 2021, Arthur Eigenbrot
       <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
    </div>
   
    <div class="right-footer">
      Last updated on 19 Oct 2021.
    </div>
    <div class="centre-footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0
    </div>
  </div>
</footer>
  </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Instrument Partner Testing Access &#8212; VBI_Pipeline v1.0.0</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700" type="text/css" />
    <link rel="stylesheet" href="_static/dkist.css" type="text/css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favico.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reference/API" href="API.html" />
    <link rel="prev" title="Configuration File Format" href="config_file.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head><body>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="col-md-3 navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://nso.edu"><img src="_static/img/NSOlogo.gif">
        </a>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav hidden">
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">VBI Pipeline Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="walkthrough.html">Data Reduction Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_file.html">Configuration File Format</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Instrument Partner Testing Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">Reference/API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Instrument Partner Testing Access</a><ul>
<li><a class="reference internal" href="#dark-calibration">Dark Calibration</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gain-calibration">Gain Calibration</a><ul>
<li><a class="reference internal" href="#id1">Usage</a></li>
<li><a class="reference internal" href="#id2">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#target-calibration">Target Calibration</a><ul>
<li><a class="reference internal" href="#id3">Usage</a></li>
<li><a class="reference internal" href="#id4">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#science-calibration">Science Calibration</a><ul>
<li><a class="reference internal" href="#id5">Usage</a></li>
<li><a class="reference internal" href="#id6">Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="config_file.html" title="Previous Chapter: Configuration File Format"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Configuration...</span>
    </a>
  </li>
  <li>
    <a href="API.html" title="Next Chapter: Reference/API"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Reference/API &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>
          
            <ul class="nav navbar-nav navbar-left">
              <li><a href="http://dkist.nso.edu/">DKIST</a></li>
            </ul>
          
          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">

    <div class="col-md-3"><div id="side-logo" >
            <a href="http://dkist.nso.edu">
                <img src="_static/img/DKISTLogo-Medium.jpg">
            </a>
        </div><div id="sidebar" class="bs-sidenav" role="complementary">
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">VBI Pipeline Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="walkthrough.html">Data Reduction Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_file.html">Configuration File Format</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Instrument Partner Testing Access</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dark-calibration">Dark Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gain-calibration">Gain Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#target-calibration">Target Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#science-calibration">Science Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="API.html">Reference/API</a></li>
</ul>

            
        </div>
    </div>

    <div class="body col-md-9 content" role="main">
      
  <section id="instrument-partner-testing-access">
<h1>Instrument Partner Testing Access<a class="headerlink" href="#instrument-partner-testing-access" title="Permalink to this headline">¶</a></h1>
<p>As of version 0.7.1 the pipeline also provides command-line level access to the individual modules of the VBI Pipeline.
These scripts are useful for testing and debugging each step of the VBI Pipeline individually. In each case they provide
complete access to each step’s <code class="xref py py-obj docutils literal notranslate"><span class="pre">main()</span></code> function, with all optional parameters exposed as command line options. Unless
set by the user the optional parameters fall back on the package defaults (the same as when running the main
<code class="docutils literal notranslate"><span class="pre">vbi_pipeline</span></code> program).</p>
<p>The outputs of these scripts are suitable for use in the <code class="docutils literal notranslate"><span class="pre">Main</span></code> section of the standard configuration file.</p>
<section id="dark-calibration">
<h2>Dark Calibration<a class="headerlink" href="#dark-calibration" title="Permalink to this headline">¶</a></h2>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: vbi_dark [-h] [-f] [-L LOW_THRESH] [-H HIGH_THRESH] dark_dir output</span>

<span class="go">Run the VBI Pipeline&#39;s Dark Calibration module. This is a direct hook into</span>
<span class="go">DarkCalibration.main()and all kwargs are exposed as command line options</span>

<span class="go">positional arguments:</span>
<span class="go">  dark_dir              Directory containing raw dark images</span>
<span class="go">  output                Location to save Dark Calibration FITS object</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  -f, --force           Overwrite output</span>
<span class="go">  -L LOW_THRESH, --low-thresh LOW_THRESH</span>
<span class="go">                        Low acceptance threshold</span>
<span class="go">  -H HIGH_THRESH, --high-thresh HIGH_THRESH</span>
<span class="go">                        High acceptance threshold</span>
<span class="go">  -S SUFFIX, --suffix SUFFIX</span>
<span class="go">                        Only load files with this extension. Default is &quot;FITS&quot;</span>
</pre></div>
</div>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>vbi_dark ../input_data DC.FITS
</pre></div>
</div>
</section>
</section>
<section id="gain-calibration">
<h2>Gain Calibration<a class="headerlink" href="#gain-calibration" title="Permalink to this headline">¶</a></h2>
<section id="id1">
<h3>Usage<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: vbi_gain [-h] [-f] [-D DARK_CAL] [-L LOW_THRESH] [-H HIGH_THRESH]</span>
<span class="go">                gain_dir output</span>

<span class="go">Run the VBI Pipeline&#39;s Gain Calibration module. This is a direct hook into</span>
<span class="go">GainCalibration.main()and all kwargs are exposed as command line options</span>

<span class="go">positional arguments:</span>
<span class="go">  gain_dir              Directory containing raw dark images</span>
<span class="go">  output                Location to save Gain Calibration FITS object</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  -f, --force           Overwrite output</span>
<span class="go">  -D DARK_CAL, --dark_cal DARK_CAL</span>
<span class="go">                        Location of Dark Calibration object FITS file. If none</span>
<span class="go">                        is provided thenno dark correction will be done.</span>
<span class="go">  -L LOW_THRESH, --low-thresh LOW_THRESH</span>
<span class="go">                        Low acceptance threshold</span>
<span class="go">  -H HIGH_THRESH, --high-thresh HIGH_THRESH</span>
<span class="go">                        High acceptance threshold</span>
<span class="go">  -S SUFFIX, --suffix SUFFIX</span>
<span class="go">                        Only load files with this extension. Default is &quot;FITS&quot;</span>
</pre></div>
</div>
</section>
<section id="id2">
<h3>Example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>vbi_gain ../input_data GC.FITS -D DC.FITS
</pre></div>
</div>
</section>
</section>
<section id="target-calibration">
<h2>Target Calibration<a class="headerlink" href="#target-calibration" title="Permalink to this headline">¶</a></h2>
<p>There are a lot of options here that should probably be left alone. Many of the defaults are critically important to
a successful TargetCal run.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Target Calibration will likely fail if you do not provide both Dark Calibration (<code class="docutils literal notranslate"><span class="pre">-D</span></code>) and Gain Calibration
(<code class="docutils literal notranslate"><span class="pre">-G</span></code>) objects.</p>
</div>
<section id="id3">
<h3>Usage<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: vbi_target [-h] [-f] [-D DARK_CAL] [-G GAIN_CAL] [-g GAUSS_SIGMA]</span>
<span class="go">                  [-d DMAX] [-r RHO_MIN_DIST] [-i REFIDX] [-R RHO_SMOOTH]</span>
<span class="go">                  [-t BINARY_THRESHOLD] [-s SIGCLIP] [-p]</span>
<span class="go">                  grid_dir output</span>

<span class="go">Run the VBI Pipeline&#39;s Target Calibration module. This is a direct hook into</span>
<span class="go">TargetCalibration.main()and all kwargs are exposed as command line options</span>

<span class="go">positional arguments:</span>
<span class="go">  grid_dir              Directory containing raw GOS grid images</span>
<span class="go">  output                Location to save Target Calibration FITS object</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  -f, --force           Overwrite output</span>
<span class="go">  -D DARK_CAL, --dark-cal DARK_CAL</span>
<span class="go">                        Location of Dark Calibration object FITS file. If none</span>
<span class="go">                        is provided then no dark correction will be done.</span>
<span class="go">  -G GAIN_CAL, --gain-cal GAIN_CAL</span>
<span class="go">                        Location of Gain Calibration object FITS file. If none</span>
<span class="go">                        is provided then no gain correction will be done.</span>
<span class="go">  -g GAUSS_SIGMA, --gauss-sigma GAUSS_SIGMA</span>
<span class="go">                        Width of smoothing kernel used to construct a binary</span>
<span class="go">                        image from the input data. Should be slightly less</span>
<span class="go">                        than the pixel width of the grid lines.</span>
<span class="go">  -d DMAX, --dmax DMAX  Any intersections with pixel locations less than dmax</span>
<span class="go">                        apart are considered to be the same intersection.</span>
<span class="go">  -r RHO_MIN_DIST, --rho-min-dist RHO_MIN_DIST</span>
<span class="go">                        Minimum distance (in Hough space coordinates) allowed</span>
<span class="go">                        between peaks in rho. This parameter is highly</span>
<span class="go">                        dependent on the pixel scale of the grid lines.</span>
<span class="go">  -i REF_POS, --ref_pos REF_POS</span>
<span class="go">                        Camera position to use as reference</span>
<span class="go">  -R RHO_SMOOTH, --rho-smooth RHO_SMOOTH</span>
<span class="go">                        Sigma of smoothing kernel used to remove noise from</span>
<span class="go">                        the rho rss. Something b/t 5 and 10 is probably good.</span>
<span class="go">  -t BINARY_THRESHOLD, --binary-threshold BINARY_THRESHOLD</span>
<span class="go">                        Min percentage of pixels to be on one side of the Otsu</span>
<span class="go">                        threshold when constructing the binary image. If the</span>
<span class="go">                        percentage of pixels above the threshold is outside</span>
<span class="go">                        the range (binary_threshold, 1 - binary_threshold),</span>
<span class="go">                        then some cleaning of outlying pixels is performed.</span>
<span class="go">  -P PEAK_THRESHOLD, --peak-threshold PEAK_THRESHOLD</span>
<span class="go">                        Relative cutoff for detecting peaks in the Hough transform</span>
<span class="go">                        [0 - 1]. Larger numbers will exclude shorter lines, but can</span>
<span class="go">                        help if spurious lines are being detected.</span>
<span class="go">  -w THETA_WINDOW, --theta-window THETA_WINDOW</span>
<span class="go">                        Size of region (in radians) around the peak angles to include</span>
<span class="go">                        when looking for peaks in the Hough rho dimension. Smaller numbers</span>
<span class="go">                        can improve the centering of rho peaks.</span>
<span class="go">  -s SIGCLIP, --sigclip SIGCLIP</span>
<span class="go">                        Any pixels beyond sigclip standard deviations from the</span>
<span class="go">                        mean are excluded from the binary thresholding</span>
<span class="go">                        calculation.</span>
<span class="go">  -p, --debug           If True the code will stop at each hdu (i.e., camera</span>
<span class="go">                        position) and generate some diagnostic plots that show</span>
<span class="go">                        the computed lines and grid intersections.</span>
</pre></div>
</div>
</section>
<section id="id4">
<h3>Example<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>vbi_target ../input_data TC.FITS -D DC.FITS -G GC.FITS
</pre></div>
</div>
</section>
</section>
<section id="science-calibration">
<h2>Science Calibration<a class="headerlink" href="#science-calibration" title="Permalink to this headline">¶</a></h2>
<section id="id5">
<h3>Usage<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">usage: vbi_science [-h] [-f] [-a] [-D DARK_CAL] [-G GAIN_CAL] [-T TARGET_CAL]</span>
<span class="go">                   [-S SUFFIX] [-I DATASET_ID] data_dir output</span>

<span class="go">Run the VBI Pipeline&#39;s Science Calibration module. This is a direct hook into</span>
<span class="go">ScienceCalibration.main()and all kwargs are exposed as command line options</span>

<span class="go">positional arguments:</span>
<span class="go">  data_dir              Directory containing raw observation images</span>
<span class="go">  output                Location to save Science Calibration FITS object</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  -f, --force           Overwrite output</span>
<span class="go">  -a, --average         Average all exposures from the same spatial positions together</span>
<span class="go">  -D DARK_CAL, --dark-cal DARK_CAL</span>
<span class="go">                        Location of Dark Calibration object FITS file. If none is</span>
<span class="go">                        provided then no dark correction will be done.</span>
<span class="go">  -G GAIN_CAL, --gain-cal GAIN_CAL</span>
<span class="go">                        Location of Gain Calibration object FITS file. If none is</span>
<span class="go">                        provided then no gain correction will be done.</span>
<span class="go">  -T TARGET_CAL, --target-cal TARGET_CAL</span>
<span class="go">                        Location of Target Calibration object FITS file. If none is</span>
<span class="go">                        provided then no target calibration will be done.</span>
<span class="go">  -S SUFFIX, --suffix SUFFIX</span>
<span class="go">                        Only load files with this extension. Default is &quot;FITS&quot;</span>
<span class="go">  -I DATASET_ID, --dataset-ID DATASET_ID</span>
<span class="go">                        Only reduce observation data that have ID___003 equal to dataset-ID.</span>
<span class="go">                        If blank, reduce all data found (sorting by DATASET_ID).</span>
<span class="go">  -K, --skip-cal-verification</span>
<span class="go">                        Skip verification of Cal objects</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>Example<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>vbi_science ../input_data Sci -D DC.FITS -G GC.FITS -T TC.FITS -I <span class="s1">&#39;sunspot 1&#39;</span>
</pre></div>
</div>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <div class="left-footer">
         &copy; 2021, Arthur Eigenbrot
       <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a>
    </div>
   
    <div class="right-footer">
      Last updated on 19 Oct 2021.
    </div>
    <div class="centre-footer">
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0
    </div>
  </div>
</footer>
  </body>
</html>